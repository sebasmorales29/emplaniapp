@model Emplaniapp.UI.Models.ForgotPasswordViewModel
@{
    ViewBag.Title = "Recuperar contraseña";
    Layout = "~/Views/Shared/_LoginLayout.cshtml";
}

<div class="sign-user_card bg-white">

    <!-- Header de la empresa -->
    <div class="text-center">
        <img src="~/Content/Images/Emplaniapp_Logo1.png" alt="Emplaniapp" style="max-height:80px;">
    </div>

    <br />
    <h3 class="mb-4 text-center">Solicitar una contraseña nueva</h3>

    <!-- Form -->
    <div class="form-input">
        @using (Html.BeginForm("ForgotPassword", "Account", FormMethod.Post, new { role = "form", id = "forgotForm", novalidate = "novalidate" }))
        {
            @Html.AntiForgeryToken()

            @Html.ValidationSummary(true, "Por favor corrige los siguientes errores:", new { @class = "validation-summary advertencia" })

            <div class="row mb-3">
                <div class="col-lg-12">
                    <div class="form-group">
                        @Html.LabelFor(m => m.Email, new { @class = "form-label text-secondary", @for = "Email" })
                        @Html.TextBoxFor(m => m.Email, new
                        {
                            @class = "floating-input form-control text-center",
                            type = "email",
                            placeholder = "correo@ejemplo.com",
                            autocomplete = "email",
                            required = "required",
                            id = "Email",
                            inputmode = "email"
                        })
                        @Html.ValidationMessageFor(m => m.Email, "", new { @class = "advertencia" })
                    </div>
                </div>
            </div>

            <button type="submit" class="btn btn-primary w-100" id="forgotBtn">
                Enviar enlace
            </button>
        }
    </div>

    <div class="mt-4 text-center" style="text-size-adjust:auto;">
        <a href="@Url.Action("Login","Account")">Volver a iniciar sesión</a>
    </div>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script>
        (function () {
            var $form = $('#forgotForm');
            var $btn = $('#forgotBtn');

            if ($form.length && $btn.length) {
                $form.on('submit', function () {
                    $btn.addClass('btn-loading').prop('disabled', true);
                    setTimeout(function () {
                        if ($('.field-validation-error:visible').length > 0 || $('.validation-summary:visible').length > 0) {
                            $btn.removeClass('btn-loading').prop('disabled', false);
                        }
                    }, 120);
                });
            }

            // Animación de entrada (opcional)
            setTimeout(function () {
                $('.sign-user_card').css({ animation: 'slideInUp .6s ease-out', opacity: '1' });
            }, 100);
        })();
    </script>
}
